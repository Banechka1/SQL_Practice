# LeetCode SQL 04.04.2024
### 175
---
```
SELECT FirstName, LastName, City, State FROM Person 
LEFT JOIN Address USING(PersonId)
```
![image](https://github.com/Banechka1/SQL_Practice/assets/108561676/12441a7f-a621-49b6-b0ea-1f7d475f66cb)

---

### 176
---
```
SELECT max(salary) AS SecondHighestSalary 
FROM Employee  
WHERE Salary <> (SELECT max(salary) FROM Employee)
```
![image](https://github.com/Banechka1/SQL_Practice/assets/108561676/c3ecc35b-f410-49cc-aefc-c0fe58d84916)

---

### 177
---
```
CREATE FUNCTION getNthHighestSalary(N INT) RETURNS INT 
BEGIN 
SET N=N-1; 
    RETURN ( 
        SELECT DISTINCT salary FROM Employee ORDER BY salary DESC LIMIT N OFFSET 1 
    ); 
END
```
![image](https://github.com/Banechka1/SQL_Practice/assets/108561676/e2c30022-6449-4657-b1ab-483f9dcffc5f)

---

### 178
---
```
SELECT s.Score , COUNT(t.Score) AS 'Rank' FROM 
(SELECT DISTINCT Score FROM Scores) AS t , Scores AS s 
WHERE s.Score <= t.Score 
GROUP BY s.id, s.Score 
ORDER BY s.Score DESC;
```
![image](https://github.com/Banechka1/SQL_Practice/assets/108561676/a7ddd411-e932-44a7-a02e-622e1c967668)

---

### 181
---
```
SELECT e1.name AS Employee FROM Employee e1 
JOIN Employee e2 ON e1.managerId = e2.Id AND e1.salary > e2.salary;
```
![image](https://github.com/Banechka1/SQL_Practice/assets/108561676/986abec3-f5f0-4b73-86f8-3ba26f954ab1)

---

### 182
---
```
SELECT email as Email FROM Person  
GROUP BY email HAVING COUNT(*) > 1;
```
![image](https://github.com/Banechka1/SQL_Practice/assets/108561676/66be0dba-db9d-4320-ad90-1710d7859e0a)

---
